{% extends 'image_app/base.html' %}
{% load static %}

{% block title %}Professional Image Compressor Online Free | Compress JPEG, PNG, WebP | resizeimages.tools{% endblock %}
{% block description %}Free professional image compressor tool. Compress JPEG, PNG, WebP images online with advanced algorithms. Reduce file sizes by up to 90% while maintaining quality. Batch processing supported.{% endblock %}
{% block keywords %}image compressor, compress jpeg online, png compressor, webp optimizer, batch image compression, reduce image size, photo compressor, optimize images for web{% endblock %}
{% block canonical %}https://resizeimages.tools/image-compressor/{% endblock %}

{% block extra_css %}
<style>
    :root {
        --primary: #7C3AED;
        --primary-hover: #6D28D9;
        --primary-light: #F5F3FF;
        --secondary: #059669;
        --secondary-hover: #047857;
        --accent: #DC2626;
        --background: #F9FAFB;
        --surface: #FFFFFF;
        --text-primary: #111827;
        --text-secondary: #6B7280;
        --border: #E5E7EB;
        --shadow-sm: 0 1px 2px rgba(0, 0, 0, 0.05);
        --shadow-md: 0 4px 6px rgba(0, 0, 0, 0.07);
        --shadow-lg: 0 10px 15px rgba(0, 0, 0, 0.1);
        --shadow-xl: 0 20px 25px rgba(0, 0, 0, 0.15);
        --radius-sm: 6px;
        --radius-md: 10px;
        --radius-lg: 14px;
        --radius-xl: 18px;
    }

    * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
    }

    body {
        background: linear-gradient(135deg, #F9FAFB 0%, #F3F4F6 100%);
        font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        color: var(--text-primary);
        line-height: 1.6;
        min-height: 100vh;
    }

    .hero-section {
        background: linear-gradient(135deg, #7C3AED 0%, #A855F7 50%, #C084FC 100%);
        color: white;
        padding: 3rem 1.5rem 2.5rem;
        text-align: center;
        position: relative;
        overflow: hidden;
    }

    .hero-section::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: radial-gradient(circle at 30% 50%, rgba(255,255,255,0.1) 0%, transparent 50%);
        pointer-events: none;
    }

    .hero-content {
        position: relative;
        z-index: 1;
        max-width: 750px;
        margin: 0 auto;
    }

    .hero-badge {
        display: inline-flex;
        align-items: center;
        gap: 0.5rem;
        background: rgba(255, 255, 255, 0.2);
        backdrop-filter: blur(10px);
        padding: 0.5rem 1rem;
        border-radius: 50px;
        font-size: 0.875rem;
        margin-bottom: 1.25rem;
        border: 1px solid rgba(255, 255, 255, 0.3);
        font-weight: 600;
    }

    .hero-title {
        font-size: clamp(2rem, 5vw, 2.75rem);
        font-weight: 900;
        margin-bottom: 0.75rem;
        letter-spacing: -0.03em;
        line-height: 1.1;
    }

    .hero-subtitle {
        font-size: clamp(1rem, 2.5vw, 1.125rem);
        opacity: 0.95;
        line-height: 1.6;
        font-weight: 400;
        max-width: 600px;
        margin: 0 auto;
    }

    .main-container {
        max-width: 850px;
        margin: -2rem auto 3rem;
        padding: 0 1.5rem;
        position: relative;
        z-index: 10;
    }

    .upload-card {
        background: var(--surface);
        border-radius: var(--radius-xl);
        box-shadow: var(--shadow-xl);
        overflow: hidden;
        border: 1px solid var(--border);
    }

    .card-section {
        padding: 2rem;
    }

    .section-title {
        font-size: 1.125rem;
        font-weight: 700;
        color: var(--text-primary);
        margin-bottom: 1.25rem;
        display: flex;
        align-items: center;
        gap: 0.75rem;
    }

    .section-icon {
        width: 32px;
        height: 32px;
        background: linear-gradient(135deg, var(--primary) 0%, #A855F7 100%);
        color: white;
        border-radius: 8px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 0.875rem;
        box-shadow: 0 4px 12px rgba(124, 58, 237, 0.3);
    }

    .upload-zone {
        background: linear-gradient(135deg, #FAFAFB 0%, #F3F4F6 100%);
        border: 2px dashed var(--border);
        border-radius: var(--radius-lg);
        padding: 2.5rem 2rem;
        text-align: center;
        cursor: pointer;
        transition: all 0.3s ease;
        position: relative;
    }

    .upload-zone:hover,
    .upload-zone.drag-active {
        border-color: var(--primary);
        background: linear-gradient(135deg, #FAF5FF 0%, #F3E8FF 100%);
        transform: translateY(-2px);
        box-shadow: 0 8px 20px rgba(124, 58, 237, 0.15);
    }

    .upload-icon {
        width: 64px;
        height: 64px;
        margin: 0 auto 1.25rem;
        background: linear-gradient(135deg, var(--primary) 0%, #A855F7 100%);
        border-radius: 16px;
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-size: 1.75rem;
        box-shadow: 0 8px 24px rgba(124, 58, 237, 0.4);
        transition: all 0.3s ease;
    }

    .upload-zone:hover .upload-icon {
        transform: scale(1.1) rotate(5deg);
    }

    .upload-title {
        font-size: 1.125rem;
        font-weight: 700;
        color: var(--text-primary);
        margin-bottom: 0.5rem;
    }

    .upload-description {
        color: var(--text-secondary);
        font-size: 0.9375rem;
        margin-bottom: 1.25rem;
    }

    .file-input {
        display: none;
    }

    .upload-button {
        background: linear-gradient(135deg, var(--primary) 0%, #A855F7 100%);
        color: white;
        border: none;
        padding: 0.75rem 2rem;
        border-radius: var(--radius-md);
        font-size: 0.9375rem;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s ease;
        pointer-events: none;
        box-shadow: 0 4px 12px rgba(124, 58, 237, 0.3);
        display: inline-flex;
        align-items: center;
        gap: 0.5rem;
    }

    .upload-specs {
        display: flex;
        justify-content: center;
        gap: 1.5rem;
        margin-top: 1.25rem;
        padding-top: 1.25rem;
        border-top: 1px solid var(--border);
        font-size: 0.875rem;
    }

    .spec-item {
        display: flex;
        align-items: center;
        gap: 0.5rem;
        color: var(--text-secondary);
        font-weight: 500;
    }

    .spec-icon {
        color: var(--primary);
    }

    .preview-section {
        display: none;
        padding: 1.25rem;
        background: linear-gradient(to right, #FAF5FF 0%, #F3E8FF 100%);
        border-radius: var(--radius-lg);
        border: 1px solid #D8B4FE;
        margin-top: 1rem;
    }

    .preview-section.active {
        display: block;
        animation: slideIn 0.4s ease;
    }

    @keyframes slideIn {
        from {
            opacity: 0;
            transform: translateY(-10px);
        }
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }

    .preview-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 1rem;
        color: var(--text-primary);
        font-weight: 600;
    }

    .clear-all-btn {
        background: var(--accent);
        color: white;
        border: none;
        padding: 0.5rem 1rem;
        border-radius: var(--radius-sm);
        font-size: 0.8rem;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s ease;
        display: inline-flex;
        align-items: center;
        gap: 0.4rem;
    }

    .clear-all-btn:hover {
        background: #B91C1C;
        transform: translateY(-1px);
    }

    .preview-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
        gap: 1rem;
    }

    .file-preview {
        background: white;
        border: 1px solid var(--border);
        border-radius: var(--radius-md);
        overflow: hidden;
        position: relative;
        transition: all 0.3s ease;
    }

    .file-preview:hover {
        transform: translateY(-2px);
        box-shadow: var(--shadow-lg);
    }

    .preview-image {
        width: 100%;
        height: 80px;
        object-fit: cover;
    }

    .file-info {
        padding: 0.75rem;
    }

    .file-name {
        font-weight: 500;
        font-size: 0.75rem;
        color: var(--text-primary);
        margin-bottom: 0.25rem;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
    }

    .file-size {
        font-size: 0.7rem;
        color: var(--text-secondary);
    }

    .remove-btn {
        position: absolute;
        top: 0.25rem;
        right: 0.25rem;
        background: rgba(239, 68, 68, 0.9);
        color: white;
        border: none;
        width: 22px;
        height: 22px;
        border-radius: 50%;
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 0.7rem;
        opacity: 0;
        transition: all 0.3s ease;
    }

    .file-preview:hover .remove-btn {
        opacity: 1;
    }

    .options-section {
        border-top: 1px solid var(--border);
        background: #FAFAFA;
    }

    .quality-section {
        margin-bottom: 1.5rem;
    }

    .quality-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 0.75rem;
    }

    .quality-label {
        color: var(--text-primary);
        font-weight: 500;
        font-size: 0.95rem;
    }

    .quality-value {
        background: var(--primary);
        color: white;
        padding: 0.3rem 0.8rem;
        border-radius: 15px;
        font-weight: 600;
        font-size: 0.85rem;
    }

    .quality-slider {
        width: 100%;
        height: 6px;
        border-radius: 10px;
        background: #E5E7EB;
        outline: none;
        -webkit-appearance: none;
    }

    .quality-slider::-webkit-slider-thumb {
        -webkit-appearance: none;
        width: 20px;
        height: 20px;
        border-radius: 50%;
        background: white;
        cursor: pointer;
        border: 3px solid var(--primary);
        box-shadow: var(--shadow-sm);
        transition: all 0.2s ease;
    }

    .quality-slider::-webkit-slider-thumb:hover {
        transform: scale(1.1);
        box-shadow: var(--shadow-md);
    }

    .quality-labels {
        display: flex;
        justify-content: space-between;
        color: var(--text-secondary);
        font-size: 0.75rem;
        margin-top: 0.5rem;
    }

    .options-grid {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 1rem;
        margin-bottom: 1.5rem;
    }

    .option-card {
        background: white;
        border: 2px solid var(--border);
        border-radius: var(--radius-md);
        padding: 1rem;
        cursor: pointer;
        transition: all 0.3s ease;
        display: flex;
        align-items: center;
        gap: 0.75rem;
    }

    .option-card:hover {
        border-color: var(--primary);
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(124, 58, 237, 0.15);
    }

    .option-card.checked {
        border-color: var(--primary);
        background: linear-gradient(135deg, #FAF5FF 0%, #F3E8FF 100%);
    }

    .option-checkbox {
        width: 20px;
        height: 20px;
        border: 2px solid var(--border);
        border-radius: 50%;
        position: relative;
        transition: all 0.3s ease;
        flex-shrink: 0;
    }

    .option-card.checked .option-checkbox {
        border-color: var(--primary);
        background: var(--primary);
    }

    .option-card.checked .option-checkbox::after {
        content: 'âœ“';
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        color: white;
        font-size: 0.75rem;
        font-weight: 700;
    }

    .option-details {
        flex: 1;
    }

    .option-title {
        font-size: 0.9375rem;
        font-weight: 700;
        color: var(--text-primary);
        margin-bottom: 0.25rem;
    }

    .option-description {
        font-size: 0.8125rem;
        color: var(--text-secondary);
    }

    .compress-button {
        width: 100%;
        background: linear-gradient(135deg, var(--primary) 0%, #A855F7 100%);
        color: white;
        border: none;
        padding: 1rem 2rem;
        border-radius: var(--radius-md);
        font-size: 1rem;
        font-weight: 700;
        cursor: pointer;
        transition: all 0.3s ease;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 0.625rem;
        box-shadow: 0 4px 12px rgba(124, 58, 237, 0.3);
        margin-top: 1.5rem;
    }

    .compress-button:hover:not(:disabled) {
        transform: translateY(-2px);
        box-shadow: 0 6px 16px rgba(124, 58, 237, 0.4);
    }

    .compress-button:disabled {
        opacity: 0.5;
        cursor: not-allowed;
    }

    .loading-overlay {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(255, 255, 255, 0.98);
        z-index: 9999;
        align-items: center;
        justify-content: center;
        backdrop-filter: blur(10px);
    }

    .loading-overlay.active {
        display: flex;
    }

    .loading-content {
        text-align: center;
        max-width: 320px;
    }

    .loading-spinner {
        width: 64px;
        height: 64px;
        margin: 0 auto 1.5rem;
        border: 5px solid #E5E7EB;
        border-top-color: var(--primary);
        border-radius: 50%;
        animation: spin 0.8s linear infinite;
    }

    @keyframes spin {
        to { transform: rotate(360deg); }
    }

    .loading-title {
        font-size: 1.25rem;
        font-weight: 700;
        margin-bottom: 0.5rem;
    }

    .loading-subtitle {
        font-size: 1rem;
        color: var(--text-secondary);
    }

    .progress-bar-container {
        width: 100%;
        height: 8px;
        background: #E5E7EB;
        border-radius: 10px;
        overflow: hidden;
        margin: 1rem 0;
    }

    .progress-bar {
        height: 100%;
        background: linear-gradient(90deg, var(--primary) 0%, #A855F7 100%);
        border-radius: 10px;
        transition: width 0.3s ease;
        width: 0%;
    }

    .results-section {
        background: var(--surface);
        border-radius: var(--radius-xl);
        box-shadow: var(--shadow-xl);
        padding: 2rem;
        margin: 2rem 0;
        display: none;
        border: 1px solid var(--border);
    }

    .results-section.active {
        display: block;
        animation: slideIn 0.3s ease-out;
    }

    .results-header {
        text-align: center;
        margin-bottom: 2rem;
    }

    .results-title {
        font-size: 1.75rem;
        font-weight: 700;
        color: var(--text-primary);
        margin-bottom: 0.5rem;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 0.75rem;
    }

    .results-subtitle {
        color: var(--text-secondary);
        font-size: 1rem;
    }

    .results-stats {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
        gap: 1rem;
        margin-bottom: 2rem;
        text-align: center;
    }

    .stat-box {
        background: linear-gradient(135deg, #FAF5FF 0%, #F3E8FF 100%);
        border: 1px solid #D8B4FE;
        border-radius: var(--radius-md);
        padding: 1rem;
    }

    .stat-number {
        font-size: 1.25rem;
        font-weight: 800;
        color: var(--primary);
        display: block;
    }

    .stat-label {
        color: var(--text-secondary);
        font-size: 0.75rem;
        margin-top: 0.25rem;
        text-transform: uppercase;
        letter-spacing: 0.5px;
    }

    .results-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
        gap: 1.5rem;
        margin-bottom: 2rem;
    }

    .result-card {
        background: white;
        border: 1px solid var(--border);
        border-radius: var(--radius-lg);
        overflow: hidden;
        transition: all 0.3s ease;
    }

    .result-card:hover {
        transform: translateY(-2px);
        box-shadow: var(--shadow-lg);
    }

    .result-image {
        width: 100%;
        height: 150px;
        object-fit: cover;
    }

    .result-info {
        padding: 1rem;
    }

    .result-name {
        color: var(--text-primary);
        font-weight: 600;
        margin-bottom: 1rem;
        font-size: 0.875rem;
    }

    .result-comparison {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 1rem;
        margin-bottom: 1rem;
        text-align: center;
    }

    .comparison-item {
        background: #F9FAFB;
        padding: 0.75rem;
        border-radius: var(--radius-sm);
    }

    .comparison-label {
        color: var(--text-secondary);
        font-size: 0.75rem;
        text-transform: uppercase;
        letter-spacing: 0.5px;
        margin-bottom: 0.25rem;
    }

    .comparison-value {
        color: var(--text-primary);
        font-weight: 700;
        font-size: 1rem;
    }

    .savings-badge {
        background: linear-gradient(135deg, var(--secondary) 0%, #10B981 100%);
        color: white;
        padding: 0.5rem 1rem;
        border-radius: 20px;
        text-align: center;
        font-weight: 700;
        margin-bottom: 1rem;
        font-size: 0.875rem;
    }

    .download-btn {
        width: 100%;
        background: linear-gradient(135deg, var(--primary) 0%, #A855F7 100%);
        color: white;
        border: none;
        padding: 0.75rem 1rem;
        border-radius: var(--radius-md);
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s ease;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 0.5rem;
    }

    .download-btn:hover {
        transform: translateY(-1px);
        box-shadow: var(--shadow-md);
    }

    .download-all-btn {
        background: linear-gradient(135deg, var(--secondary) 0%, #10B981 100%);
        color: white;
        border: none;
        padding: 1rem 2rem;
        border-radius: 50px;
        font-weight: 700;
        font-size: 1rem;
        cursor: pointer;
        transition: all 0.3s ease;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 0.75rem;
        margin: 0 auto;
        box-shadow: var(--shadow-lg);
    }

    .download-all-btn:hover {
        transform: translateY(-2px);
        box-shadow: var(--shadow-xl);
    }

    .content-wrapper {
        max-width: 1100px;
        margin: 3rem auto;
        padding: 0 1.5rem;
    }

    .content-section {
        background: white;
        border-radius: var(--radius-xl);
        padding: 3rem;
        margin-bottom: 2rem;
        box-shadow: var(--shadow-md);
        border: 1px solid var(--border);
    }

    .content-heading {
        font-size: 2rem;
        font-weight: 800;
        color: var(--text-primary);
        margin-bottom: 1.5rem;
        line-height: 1.3;
    }

    .content-text {
        color: var(--text-secondary);
        font-size: 1.0625rem;
        line-height: 1.8;
        margin-bottom: 1.25rem;
    }

    .features-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
        gap: 1.75rem;
        margin-top: 2rem;
    }

    .feature-card {
        background: linear-gradient(to bottom, #FFFFFF 0%, #FAFAFA 100%);
        border-radius: var(--radius-lg);
        padding: 2rem;
        border: 1px solid var(--border);
        transition: all 0.4s ease;
    }

    .feature-card:hover {
        transform: translateY(-8px);
        box-shadow: 0 12px 32px rgba(0, 0, 0, 0.12);
        border-color: rgba(124, 58, 237, 0.2);
    }

    .feature-icon {
        width: 48px;
        height: 48px;
        background: linear-gradient(135deg, var(--primary) 0%, #A855F7 100%);
        border-radius: 12px;
        display: flex;
        align-items: center;
        justify-content: center;
        margin-bottom: 1.25rem;
        color: white;
        font-size: 1.25rem;
        box-shadow: 0 6px 16px rgba(124, 58, 237, 0.3);
    }

    .feature-title {
        font-size: 1.125rem;
        font-weight: 700;
        color: var(--text-primary);
        margin-bottom: 0.75rem;
    }

    .feature-description {
        color: var(--text-secondary);
        line-height: 1.7;
        font-size: 0.9375rem;
    }

    @media (max-width: 768px) {
        .hero-section {
            padding: 2.5rem 1.25rem 2rem;
        }

        .main-container {
            padding: 0 1.25rem;
        }

        .card-section {
            padding: 1.5rem;
        }

        .content-section {
            padding: 2rem 1.5rem;
        }

        .upload-specs {
            flex-direction: column;
            gap: 0.75rem;
            align-items: center;
        }

        .options-grid {
            grid-template-columns: 1fr;
        }

        .results-stats {
            grid-template-columns: repeat(2, 1fr);
        }

        .results-grid {
            grid-template-columns: 1fr;
        }

        .features-grid {
            grid-template-columns: 1fr;
        }
    }
</style>
{% endblock %}

{% block content %}
{% csrf_token %}

<div class="hero-section">
    <div class="hero-content">
        <div class="hero-badge">
            <i class="fas fa-star"></i>
            Professional Image Compressor
        </div>
        <h1 class="hero-title">Compress Images Online Free</h1>
        <p class="hero-subtitle">Advanced image compression with intelligent algorithms. Reduce file sizes by up to 90% while maintaining exceptional quality. Perfect for web optimization and professional use.</p>
    </div>
</div>

<div class="main-container">
    <div class="upload-card">
        <div class="card-section">
            <div class="section-title">
                <div class="section-icon">
                    <i class="fas fa-cloud-upload-alt"></i>
                </div>
                <span>Upload Images to Compress</span>
            </div>

            <div class="upload-zone" id="uploadZone" onclick="document.getElementById('fileInput').click()">
                <div class="upload-icon">
                    <i class="fas fa-images"></i>
                </div>
                <div class="upload-title">Drop your images here or click to browse</div>
                <div class="upload-description">Compress multiple images at once with batch processing</div>
                <button type="button" class="upload-button">
                    <i class="fas fa-folder-open"></i>
                    Choose Image Files
                </button>
                <input type="file" id="fileInput" class="file-input" accept="image/*" multiple>
                
                <div class="upload-specs">
                    <div class="spec-item">
                        <i class="fas fa-check-circle spec-icon"></i>
                        <span>Up to 20 Images</span>
                    </div>
                    <div class="spec-item">
                        <i class="fas fa-check-circle spec-icon"></i>
                        <span>Max 10MB Each</span>
                    </div>
                    <div class="spec-item">
                        <i class="fas fa-check-circle spec-icon"></i>
                        <span>All Formats</span>
                    </div>
                </div>
            </div>

            <div class="preview-section" id="previewSection">
                <div class="preview-header">
                    <h3><i class="fas fa-images"></i> Selected Images (<span id="imageCount">0</span>)</h3>
                    <button type="button" class="clear-all-btn" onclick="clearAllFiles()">
                        <i class="fas fa-trash"></i>
                        Clear All
                    </button>
                </div>
                <div class="preview-grid" id="previewGrid"></div>
            </div>
        </div>

        <div class="card-section options-section">
            <div class="section-title">
                <div class="section-icon">
                    <i class="fas fa-sliders-h"></i>
                </div>
                <span>Compression Settings</span>
            </div>

            <div class="quality-section">
                <div class="quality-header">
                    <span class="quality-label">Quality Level</span>
                    <span class="quality-value" id="qualityDisplay">80%</span>
                </div>
                <input type="range" id="qualitySlider" min="10" max="100" value="80" class="quality-slider">
                <div class="quality-labels">
                    <span>Smaller File</span>
                    <span>Better Quality</span>
                </div>
            </div>

            <div class="options-grid">
                <div class="option-card checked" id="autoRotateCard" onclick="toggleOption('autoRotate')">
                    <div class="option-checkbox"></div>
                    <div class="option-details">
                        <div class="option-title">Auto-Rotate</div>
                        <div class="option-description">Fix orientation automatically</div>
                    </div>
                    <input type="checkbox" id="autoRotate" checked style="display: none;">
                </div>
                
                <div class="option-card" id="preserveExifCard" onclick="toggleOption('preserveExif')">
                    <div class="option-checkbox"></div>
                    <div class="option-details">
                        <div class="option-title">Keep Metadata</div>
                        <div class="option-description">Preserve EXIF data</div>
                    </div>
                    <input type="checkbox" id="preserveExif" style="display: none;">
                </div>
            </div>

            <button type="button" id="compressBtn" class="compress-button" onclick="startCompression()" disabled>
                <i class="fas fa-compress-arrows-alt"></i>
                Compress Images
            </button>
        </div>
    </div>
</div>

<div class="loading-overlay" id="loadingScreen">
    <div class="loading-content">
        <div class="loading-spinner"></div>
        <div class="loading-title" id="loadingTitle">Compressing Images...</div>
        <div class="loading-subtitle" id="loadingSubtitle">Optimizing your images with advanced algorithms</div>
        <div class="progress-bar-container">
            <div class="progress-bar" id="progressBar"></div>
        </div>
        <div id="progressText" style="margin-top: 0.5rem; color: var(--text-secondary); font-size: 0.875rem;">0% Complete</div>
    </div>
</div>

<div class="main-container">
    <div class="results-section" id="resultsSection">
        <div class="results-header">
            <h2 class="results-title">
                <i class="fas fa-check-circle"></i>
                Compression Complete!
            </h2>
            <p class="results-subtitle">Your optimized images are ready for download</p>
        </div>

        <div class="results-stats">
            <div class="stat-box">
                <span class="stat-number" id="totalFiles">0</span>
                <div class="stat-label">Files Processed</div>
            </div>
            <div class="stat-box">
                <span class="stat-number" id="totalSaved">0MB</span>
                <div class="stat-label">Size Saved</div>
            </div>
            <div class="stat-box">
                <span class="stat-number" id="averageSavings">0%</span>
                <div class="stat-label">Avg Reduction</div>
            </div>
            <div class="stat-box">
                <span class="stat-number" id="processingTime">0s</span>
                <div class="stat-label">Processing Time</div>
            </div>
        </div>

        <div class="results-grid" id="resultsGrid"></div>

        <button type="button" class="download-all-btn" onclick="downloadAll()">
            <i class="fas fa-download"></i>
            Download All Images
        </button>
    </div>
</div>

<div class="content-wrapper">
    <div class="content-section">
        <h2 class="content-heading">Professional Image Compressor - Advanced Technology</h2>
        <p class="content-text">
            Our professional image compressor uses state-of-the-art algorithms to reduce file sizes by up to 90% while maintaining exceptional visual quality. Perfect for web developers, designers, photographers, and content creators who need to optimize images for faster loading times and better performance.
        </p>
        <p class="content-text">
            Whether you need to compress JPEG, PNG, WebP, or other image formats, our tool handles batch processing of up to 20 images simultaneously, making it ideal for professional workflows and large-scale projects.
        </p>

        <div class="features-grid">
            <div class="feature-card">
                <div class="feature-icon">
                    <i class="fas fa-brain"></i>
                </div>
                <div class="feature-title">Intelligent Compression</div>
                <div class="feature-description">Advanced algorithms analyze each image and apply optimal compression techniques while preserving quality</div>
            </div>

            <div class="feature-card">
                <div class="feature-icon">
                    <i class="fas fa-layer-group"></i>
                </div>
                <div class="feature-title">Batch Processing</div>
                <div class="feature-description">Compress up to 20 images at once, perfect for photographers and web developers</div>
            </div>

            <div class="feature-card">
                <div class="feature-icon">
                    <i class="fas fa-sliders-h"></i>
                </div>
                <div class="feature-title">Quality Control</div>
                <div class="feature-description">Adjust compression levels from 10% to 100% to find the perfect balance for your needs</div>
            </div>

            <div class="feature-card">
                <div class="feature-icon">
                    <i class="fas fa-shield-alt"></i>
                </div>
                <div class="feature-title">100% Secure</div>
                <div class="feature-description">Your images are processed securely and automatically deleted within 24 hours</div>
            </div>

            <div class="feature-card">
                <div class="feature-icon">
                    <i class="fas fa-tachometer-alt"></i>
                </div>
                <div class="feature-title">Lightning Fast</div>
                <div class="feature-description">Process images in seconds with our optimized compression engine</div>
            </div>

            <div class="feature-card">
                <div class="feature-icon">
                    <i class="fas fa-infinity"></i>
                </div>
                <div class="feature-title">Unlimited Use</div>
                <div class="feature-description">Compress as many images as you need - completely free with no limits</div>
            </div>
        </div>
    </div>
</div>

<script>
let selectedFiles = [];
let compressedResults = [];
let compressionStartTime = 0;

const fileInput = document.getElementById('fileInput');
const uploadZone = document.getElementById('uploadZone');
const qualitySlider = document.getElementById('qualitySlider');
const qualityDisplay = document.getElementById('qualityDisplay');

qualitySlider.addEventListener('input', function() {
    qualityDisplay.textContent = this.value + '%';
});

['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
    uploadZone.addEventListener(eventName, preventDefaults, false);
});

function preventDefaults(e) {
    e.preventDefault();
    e.stopPropagation();
}

['dragenter', 'dragover'].forEach(eventName => {
    uploadZone.addEventListener(eventName, () => {
        uploadZone.classList.add('drag-active');
    });
});

['dragleave', 'drop'].forEach(eventName => {
    uploadZone.addEventListener(eventName, () => {
        uploadZone.classList.remove('drag-active');
    });
});

uploadZone.addEventListener('drop', (e) => {
    const files = e.dataTransfer.files;
    fileInput.files = files;
    handleFileSelect({ target: { files: files } });
});

fileInput.addEventListener('change', handleFileSelect);

function handleFileSelect(e) {
    const files = Array.from(e.target.files).filter(file => {
        return file.type.startsWith('image/') && file.size <= 10 * 1024 * 1024;
    });

    if (files.length === 0) {
        alert('Please select valid image files (max 10MB each)');
        return;
    }

    if (files.length > 20) {
        files.splice(20);
        alert('Maximum 20 images allowed. First 20 selected.');
    }

    selectedFiles = files;
    displayPreviews();
    updateUI();
}

function displayPreviews() {
    const previewGrid = document.getElementById('previewGrid');
    previewGrid.innerHTML = '';
    document.getElementById('imageCount').textContent = selectedFiles.length;

    selectedFiles.forEach((file, index) => {
        const reader = new FileReader();
        reader.onload = (e) => {
            const card = document.createElement('div');
            card.className = 'file-preview';
            card.innerHTML = `
                <img src="${e.target.result}" alt="Preview" class="preview-image">
                <div class="file-info">
                    <div class="file-name" title="${file.name}">${file.name}</div>
                    <div class="file-size">${formatFileSize(file.size)}</div>
                </div>
                <button type="button" class="remove-btn" onclick="removeFile(${index})">
                    <i class="fas fa-times"></i>
                </button>
            `;
            previewGrid.appendChild(card);
        };
        reader.readAsDataURL(file);
    });
}

function updateUI() {
    if (selectedFiles.length > 0) {
        document.getElementById('previewSection').classList.add('active');
        document.getElementById('compressBtn').disabled = false;
    } else {
        document.getElementById('previewSection').classList.remove('active');
        document.getElementById('compressBtn').disabled = true;
    }
}

function removeFile(index) {
    selectedFiles.splice(index, 1);
    displayPreviews();
    updateUI();
    if (selectedFiles.length === 0) {
        fileInput.value = '';
    }
}

function clearAllFiles() {
    selectedFiles = [];
    compressedResults = [];
    displayPreviews();
    updateUI();
    fileInput.value = '';
    document.getElementById('resultsSection').classList.remove('active');
}

function toggleOption(optionId) {
    const card = document.getElementById(optionId + 'Card');
    const checkbox = document.getElementById(optionId);
    checkbox.checked = !checkbox.checked;
    card.classList.toggle('checked', checkbox.checked);
}

async function startCompression() {
    if (selectedFiles.length === 0) return;

    document.getElementById('loadingScreen').classList.add('active');
    document.getElementById('resultsSection').classList.remove('active');

    compressedResults = [];
    compressionStartTime = Date.now();
    const totalFiles = selectedFiles.length;

    for (let i = 0; i < selectedFiles.length; i++) {
        const file = selectedFiles[i];
        const progress = Math.round(((i + 1) / totalFiles) * 100);
        
        document.getElementById('loadingTitle').textContent = `Processing ${file.name}`;
        document.getElementById('loadingSubtitle').textContent = `${i + 1} of ${totalFiles} images`;
        document.getElementById('progressBar').style.width = progress + '%';
        document.getElementById('progressText').textContent = progress + '% Complete';

        try {
            const result = await compressImage(file);
            compressedResults.push(result);
        } catch (error) {
            console.error('Error processing file:', file.name, error);
        }
    }

    document.getElementById('loadingScreen').classList.remove('active');
    displayResults();
}

async function compressImage(file) {
    const formData = new FormData();
    formData.append('csrfmiddlewaretoken', document.querySelector('[name=csrfmiddlewaretoken]').value);
    formData.append('image_file', file);
    formData.append('quality', qualitySlider.value);
    formData.append('preserve_exif', document.getElementById('preserveExif').checked ? 'true' : 'false');
    formData.append('auto_rotate', document.getElementById('autoRotate').checked ? 'true' : 'false');

    const response = await fetch(window.location.href, {
        method: 'POST',
        body: formData
    });

    if (response.ok) {
        const blob = await response.blob();
        const url = URL.createObjectURL(blob);
        
        const contentDisposition = response.headers.get('Content-Disposition');
        let filename = file.name.replace(/\.[^/.]+$/, '_compressed.jpg');
        if (contentDisposition) {
            const match = contentDisposition.match(/filename="(.+)"/);
            if (match) filename = match[1];
        }

        const originalSize = file.size;
        const compressedSize = blob.size;
        const savings = Math.max(0, ((originalSize - compressedSize) / originalSize * 100));

        return {
            originalName: file.name,
            filename: filename,
            originalSize: originalSize,
            compressedSize: compressedSize,
            savings: savings,
            url: url,
            blob: blob
        };
    } else {
        throw new Error('Compression failed');
    }
}

function displayResults() {
    if (compressedResults.length === 0) return;

    const processingTime = Math.round((Date.now() - compressionStartTime) / 1000);
    const totalOriginalSize = compressedResults.reduce((sum, r) => sum + r.originalSize, 0);
    const totalCompressedSize = compressedResults.reduce((sum, r) => sum + r.compressedSize, 0);
    const totalSaved = totalOriginalSize - totalCompressedSize;
    const averageSavings = totalOriginalSize > 0 ? Math.round((totalSaved / totalOriginalSize) * 100) : 0;

    document.getElementById('totalFiles').textContent = compressedResults.length;
    document.getElementById('totalSaved').textContent = formatFileSize(totalSaved);
    document.getElementById('averageSavings').textContent = averageSavings + '%';
    document.getElementById('processingTime').textContent = processingTime + 's';

    const resultsGrid = document.getElementById('resultsGrid');
    resultsGrid.innerHTML = '';

    compressedResults.forEach((result, index) => {
        const card = document.createElement('div');
        card.className = 'result-card';
        card.innerHTML = `
            <img src="${result.url}" alt="Compressed ${result.originalName}" class="result-image">
            <div class="result-info">
                <div class="result-name">${result.originalName}</div>
                <div class="result-comparison">
                    <div class="comparison-item">
                        <div class="comparison-label">Original</div>
                        <div class="comparison-value">${formatFileSize(result.originalSize)}</div>
                    </div>
                    <div class="comparison-item">
                        <div class="comparison-label">Compressed</div>
                        <div class="comparison-value">${formatFileSize(result.compressedSize)}</div>
                    </div>
                </div>
                <div class="savings-badge">
                    ${Math.round(result.savings)}% smaller
                </div>
                <button class="download-btn" onclick="downloadFile(${index})">
                    <i class="fas fa-download"></i>
                    Download
                </button>
            </div>
        `;
        resultsGrid.appendChild(card);
    });

    document.getElementById('resultsSection').classList.add('active');
    setTimeout(() => {
        document.getElementById('resultsSection').scrollIntoView({ behavior: 'smooth', block: 'start' });
    }, 100);
}

function downloadFile(index) {
    const result = compressedResults[index];
    if (result) {
        const a = document.createElement('a');
        a.href = result.url;
        a.download = result.filename;
        a.style.display = 'none';
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
    }
}

function downloadAll() {
    compressedResults.forEach((result, index) => {
        setTimeout(() => downloadFile(index), index * 200);
    });
}

function formatFileSize(bytes) {
    if (bytes === 0) return '0 Bytes';
    const k = 1024;
    const sizes = ['Bytes', 'KB', 'MB', 'GB'];
    const i = Math.floor(Math.log(bytes) / Math.log(k));
    return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
}

window.addEventListener('beforeunload', function() {
    compressedResults.forEach(result => {
        if (result.url) URL.revokeObjectURL(result.url);
    });
});
</script>
{% endblock %}